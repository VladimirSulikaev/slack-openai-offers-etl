# Автоматическая обработка входящих офферов с помощью n8n, OpenAI и Google Sheets

## Контекст

Команде нужен был инструмент, который автоматически собирает входящие офферы из внутреннего канала, приводит их к единому формату и сохраняет в таблицу для дальнейшего анализа. Ручная обработка занимала много времени и иногда приводила к ошибкам.

## Цель проекта

Создать автоматизированный процесс, который:

* получает новые сообщения из внутреннего канала (через Slack API),
* отправляет текст на парсинг в OpenAI,
* приводит данные к единому структурированному формату,
* сохраняет результат в Google Sheets,
* упрощает сравнение и анализ офферов.

---

## Технологический стек

* n8n для автоматизации
* Slack API для получения сообщений
* OpenAI API для парсинга текста и файлов
* Google Sheets API для хранения данных
* Google Cloud Service Account для авторизации

---

## Архитектура

```
Внутренний канал -> n8n -> OpenAI -> n8n -> Google Sheets
```

<img width="1647" height="525" alt="scheme n8n" src="https://github.com/user-attachments/assets/70eb4b31-0c70-4c71-ac5d-329cdc54051f" />

---

## Логика работы

1. Получение сообщения
   n8n отслеживает появление новых сообщений и передает текст в workflow.

2. Предобработка
   Из сообщения извлекается текст и удаляются лишние элементы форматирования.

3. Парсинг через OpenAI
   Модель определяет, является ли сообщение оффером, извлекает ключевые данные, нормализует параметры и формирует структурированный JSON.

4. Формирование строки
   JSON сопоставляется с заранее настроенной структурой.

5. Сохранение
   n8n добавляет новую строку в Google Sheets, где собираются все обработанные офферы.

---

## Итоговая структура данных

Запись оффера включает основные параметры, такие как:

* информация об оффере,
* данные о приложении или продукте,
* payout и модель оплаты,
* география,
* требования и условия,
* дополнительные параметры.

(Полная структура не раскрывается из-за NDA.)

---

## Обработка и нормализация

Модель OpenAI выполняет:

* классификацию офферов,
* извлечение нескольких офферов из одного сообщения,
* нормализацию параметров,
* проверку корректности данных,
* формирование стандартизированного JSON.

Это позволяет исключить ошибки и сделать данные унифицированными.

---

## Результаты

Проект позволил:

* полностью исключить ручной ввод данных,
* увеличить скорость обработки офферов,
* снизить количество ошибок,
* упростить анализ в таблицах,
* масштабировать процесс под другие каналы и источники.

---

## Преимущества решения

* Проект построен на общедоступных технологиях.
* Легко модифицируется и расширяется.
* Прозрачная логика работы на каждом шаге.
* Подходит для масштабирования под любые текстовые источники.
